<languages />

[[Category:Software]][[Category:ComputationalChemistry]]
==Introduction==
AMS (Amsterdam Modeling Suite), est la nouvelle appellation de [[ADF/fr|ADF]] (Amsterdam Density Functional) et fait partie de la suite [https://www.scm.com/ SCM Software for Chemistry and Materials]. AMS offre des outils très performants pour la recherche en chimie computationnelle, notamment dans les domaines de la catalyse (homogène et hétérogène), la chimie inorganique, la chimie des éléments lourds, la biochimie et différents types de spectroscopie.

Tous les produits du module SCM sont disponibles&nbsp;:
*ADF
*ADF-GUI
*BAND
*BAND-GUI
*DFTB
*ReaxFF
*COSMO-RS
*QE-GUI
*NBO6

==Utiliser AMS sur Nibi==
Le module <code>ams</code> est installé sur [[Nibi/fr|Nibi]]. SHARCNET est propriétaire de cette licence qui est réservée aux centres de calcul universitaires; cette licence ne peut être utilisée pour des services de consultation ou pour tout autre usage de nature commerciale. Pour connaître les versions disponibles, lancez la commande

 [name@server $] module spider ams

Pour les commandes en rapport avec les modules, voyez [[Utiliser des modules|Utiliser des modules]].

<span id="Job_submission"></span>
===Soumettre une tâche===

Les tâches soumises sur nos grappes sont ordonnancées par Slurm; pour les détails, consultez [[Running jobs/fr|Exécuter des tâches]].

====Exemples de scripts pour une tâche AMS ====
Le script suivant demande 32 CPU sur un nœud. Veuillez utiliser un nombre raisonnable de CPU au lieu de simplement exécuter une tâche sur un nœud complet de Nibi, à moins que vous n'ayez démontré que votre tâche peut utiliser efficacement 192 CPU.
{{File
  |name=H2O_adf.sh
  |lang="bash"
  |contents=
#!/bin/bash
#SBATCH --account=def-pi
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=32          # 32 cpus on 1 node, MPI job
#SBATCH --mem-per-cpu=3G              # memory per cpu
#SBATCH --time=00-01:00               # time (DD-HH:MM)
#SBATCH --output=H2O_adf-%j.log       # output .log file

module unload openmpi
module load ams/2025.102
export SCM_TMPDIR=$SLURM_TMPDIR      # use the local disk
bash H2O_adf.run                    # run the input script
}}

Le fichier en entrée ci-dessous est utilisé dans le script.
{{File
  |name=H2O_adf.run
  |lang="text"
  |contents=#!/bin/sh
# This is a shell script for AMS
# You should use '$AMSBIN/ams' instead of '$ADFBIN/adf'

AMS_JOBNAME=H2O_adf $AMSBIN/ams <<eor
   # Input options for the AMS driver:
   System
      Atoms
         O             0.000000     0.000000     0.000000
         H             0.000000    -0.689440    -0.578509
         H             0.000000     0.689440    -0.578509
      End
   End
   Task GeometryOptimization
   GeometryOptimization
      Convergence gradients=1e-4
   End

   # The input options for ADF, which are described in this manual,
   # should be specified in the 'Engine ADF' block:

   Engine ADF
      Basis
         Type TZP
      End
      XC
         GGA PBE
      End
   EndEngine
eor
}}

<span id="Example_scripts_for_a_band_job"></span>
====Exemples de scripts pour une tâche band ====

{{File
  |name=SnO_EFG_band.run
  |lang="bash"
  |contents=#!/bin/sh
# The calculation of the electric field gradient is invoked by the EFG key block
# Since Sn is quite an heavy atom we use the scalar relativistic option.

$AMSBIN/ams <<eor

Task SinglePoint
System
   FractionalCoords True

   Lattice
      3.8029  0.0  0.0
      0.0  3.8029  0.0
      0.0  0.0  4.8382
   End

   Atoms
      O   0.0  0.0  0.0
      O   0.5  0.5  0.0
      Sn  0.0  0.5  0.2369
      Sn  0.5  0.0 -0.2369
   End
End

Engine Band
   Title SnO EFG
   NumericalQuality Basic      ! Only for speed
   Tails bas=1e-8              ! Only for reproducibility with nr. of cores
   ! useful for Moessbauer spectroscopy: density and coulomb pot. at nuclei
   PropertiesAtNuclei
   End

   EFG
      Enabled True
   End

   Basis
      Type DZ
      Core none
   End
EndEngine
eor
}}

===Remarques===
# Le fichier en entrée pour AMS est différent de celui pour ADF; le fichier en entrée précédent pour ADF ne fonctionnera pas avec le nouveau AMS. Vous trouverez des exemples dans  /opt/software/ams/2025.102/examples/.
# À l'exception du fichier en sortie .log, les fichiers sont tous sauvegardés dans le sous-répertoire AMS_JOBNAME.results. Si AMS_JOBNAME n'est pas défini dans le fichier en entrée .run, le nom par défaut sera ams.results.
# Le nom du fichier de point de sauvegarde est ams.rkf plutôt que TAPE13 dans les versions ADF précédentes.
Pour plus d'information, consultez [https://www.scm.com/support/ SCM Support].

==AMS-GUI==
===Nibi===

Sur un nœud de calcul de Nibi (durée limite de 8 heures), AMS peut être utilisée interactivement en mode graphique via OnDemand en suivant ces étapes&nbsp;:

# Connectez-vous à [https://ondemand.sharcnet.ca ondemand.sharcnet.ca].
# Sélectionnez ''Nibi Desktop'' dans ''Compute' (dans le haut).
# Sélectionnez vos options (sélectionnez 1 cœur pour une visualisation; ne sélectionnez pas ''Enable VirtualGL'') et cliquez sur ''Launcher''.
# Sélectionnez ''Launcher Nibi Desktop'' une fois que la tâche est lancée.
# Faites un clic droit sur le bureau et sélectionnez ''Open it Terminal''.
# Sélectionnez ''MATE Terminal'' dans le menu ''System Tools'' sous ''Applications''.
# <code>module unload openmpi</code>
# <code>module load ams</code>
# <code>amsinput & </code> (créer des fichers d'entrée)
# <code>amsview & </code>(visualiser les résultats)

Si vous devez sélectionner ''Enable VirtualGL'' pour un autre programme que vous utilisez, vous devez d'abord le désactiver pour AMS en le lançant avec <code>LD_PRELOAD= amsinput</code>.

Sur OnDemand, Nibi Desktop est utilisé pour exécuter des applications AMS-GUI pour, par exemple, créer les fichiers d'entrée et visualiser les résultats. Veuillez ne pas y exécuter de tâches régulières ou des tâches interactives de longue durée. Sélectionnez un seul cœur ainsi qu'une quantité de mémoire et un temps d'exécution raisonnables.