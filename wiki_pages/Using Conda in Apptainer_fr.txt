<noinclude>
<languages />
</noinclude>

Avant de commencer ce tutoriel, prenez note de quelques points importants&nbsp;:

* M√™me dans un conteneur, Conda ne devrait pas √™tre votre solution pr√©f√©r√©e. Accordez plut√¥t la priorit√© aux [[Modules/fr|modules]] de notre [[Available software/fr|pile logicielle]] et aux [[Python/fr|wheels]] parmi [[Available Python wheels/fr|ceux qui sont disponibles]]. Ces modules et wheels sont optimis√©s en fonction de nos syst√®mes et nous pouvons fournir une meilleure assistance au besoin. Pour faire ajouter un module ou un paquet, contactez le [[Technical support/fr|soutien technique]].
* Dans ce tutoriel, nous utilisons le gestionnaire de paquets [https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html micromamba] au lieu de Conda. Si vous voulez utiliser Conda, vous devez tenir compte des  [https://legal.anaconda.com/policies/en?name=terms-of-service#terms-of-service conditions d'utilisation d'Anaconda] et peut-√™tre  [https://www.anaconda.com/pricing/terms-of-service-faqs d√©tenir une licence commerciale].
* Dans ce tutoriel, nous cr√©ons une image pour lecture seule, c'est-√† dire un fichier <tt>.sif</tt> qui contient un environnement Conda avec tout ce qu'il faut pour utiliser votre application. Il est fortement recommand√© de <b>ne pas installer interactivement un logiciel dans un conteneur avec Conda</b> et aucune information ne sera donn√©e en ce sens.

La cr√©ation d'une image Apptainer et l'installation d'un logiciel dans un conteneur avec Conda est un processus en trois √©tapes.<br>
Il faut d'abord cr√©er un fichier <tt>.yml</tt> qui d√©crit l'environnement Conda √† cr√©er dans le conteneur; dans l'exemple suivant, il s'agit de <tt>environment.yml</tt>. Ce fichier contient le nom de l'environnement √† cr√©er, la liste des paquets √† installer et comment les trouver (<i>channel</i>).

{{File
  |name=environment.yml
  |lang="yaml"
  |contents=
name: base
channels:
  - conda-forge
  - bioconda
  - defaults
dependencies:
  - python
  - pip
  - star
  - bwa
  - multiqc
}}

Il faut ensuite cr√©er un  [https://apptainer.org/docs/user/main/definition_files.html fichier de d√©finition pour l'image] (nomm√© ici <tt>image.def</tt>) qui d√©crit les √©tapes pour cr√©er l'image avec Apptainer.
#T√©l√©chargez une image Docker de DockerHub qui contient le gestionnaire de paquets micromamba pr√©install√©.
#Cr√©ez dans le conteneur une copie du fichier de d√©finition <tt>environment.yml</tt>.
#Ex√©cutez micromamba pour configurer l'environnement <tt>environment.yml</tt>.

{{File
  |name=image.def
  |lang="yaml"
  |contents=
Bootstrap: docker
From: mambaorg/micromamba:latest

%files
    environment.yml /environment.yml

%post
    micromamba install -n base --file environment.yml && \
        micromamba clean --all --yes
}}

La derni√®re √©tape est de construire l'image Apptainer √† l'aide du fichier de d√©finition ci-dessus&nbsp;:
   module load apptainer
   APPTAINER_BIND=' ' apptainer build image.sif image.def

Vous pouvez maintenant tester si <code>multiqc</code> est disponible avec, par exemple, la commande
{{Command
|apptainer run image.sif multiqc --help
|result=
 
 /// MultiQC üéÉ v1.25.1
 
 Usage: multiqc [OPTIONS] [ANALYSIS DIRECTORY]
...
}}