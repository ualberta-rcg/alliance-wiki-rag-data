{{Draft}}
<languages/>
[[Category:Software]]
[https://saigegit.github.io/SAIGE-doc/ SAIGE] est un paquet R développé avec Rcpp pour l’étude d'associations pangénomiques avec les grands ensembles de données et les biobanques. 

Cette méthode

* tient compte de la parenté des échantillons sur la base des modèles mixtes généralisés;

* permet l'ajustement des modèles selon une matrice de relations génétiques complète ou clairsemée (GRM);

* fonctionne pour les traits quantitatifs et binaires;

* gère le déséquilibre des traits binaires dans les cas témoin;

* produit des calculs efficaces pour les grands ensembles de données;

* effectue des tests d'association à un seul variant;

* fournit une estimation de la taille de l'effet grâce à la régression logistique à biais réduit de Firth;

* effectue l'analyse d'association conditionnelle.

Cette page décrit l'installation du paquet 1.0.0 de SAIGE. 

<span id="Installing_SAIGE_under_the_environment_StdEnv/2020"></span>
== Installation dans l'environnement StdEnv/2020 ==

1.  Chargez les modules nécessaires.
{{Command|module load StdEnv/2020 gcc/9.3.0 r/4.2.2 savvy/2.1.0 superlu/5.2.1 flexiblas/3.0.4}}
2. Créez le répertoire d'installation.
{{Commands
|mkdir -p ~/.local/R/$EBVERSIONR/
|export R_LIBS{{=}}~/.local/R/$EBVERSIONR/
}}
3. Installez les [[R/fr#Installation_des_paquets_R|dépendances de R]]. Il est important d'installer exactement ces versions.Si au cours de l'installation on vous demande d'installer la plus récente version d'une dépendance, appuyez sur Enter pour refuser.

<syntaxhighlight lang="bash">
[name@server ~]$ R -e 'install.packages("remotes", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("Rcpp", version="1.0.10", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("RcppParallel", version="5.1.6", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("data.table", version="1.17.8", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("RcppArmadillo", version="14.0.2-1", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("SPAtest", version="3.1.2", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("RcppEigen", version="0.3.3.9.3", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("BH", version="1.81.0-1", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("optparse", version="1.7.3", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("SKAT", version="2.2.5", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("MetaSKAT", version="0.82", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("qlcMatrix", version="0.9.5", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("RhpcBLASctl", version="0.23-42", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("RSQLite", version="2.3.8", repos="https://cloud.r-project.org/")'
[name@server ~]$ R -e 'remotes::install_version("dplyr", version="1.1.0", repos="https://cloud.r-project.org/")'
</syntaxhighlight>

4. Téléchargez la version 1.0.0 de SAIGE.
{{Commands
|git clone --recursive https://github.com/saigegit/SAIGE.git -b 1.0.0
|cd SAIGE/
}}
5. Modifiez l'installation.
{{Commands
|rm configure
|sed -i 's/llapack/lflexiblas/' src/Makevars
}}
Supprimez d'abord le fichier <i>configure</i> pour éviter d'installer des dépendances qui sont déjà disponibles. Ensuite, modifiez le nom de la bibliothèque pour qu'elle utilise le fichier <i>Makevars</i> et que les options utilisent FlexiBLAS. Vous évitez ainsi d'obtenir le message d'erreur <i>unable to find -llapack</i> à l'installation. Pour plus d'information, lisez [[BLAS_and_LAPACK/fr| BLAS et LAPACK]].

6. Compilez et installez.
{{Command|R CMD INSTALL .}}
7. Effectuez un test.
{{Command|R -e 'library(SAIGE)'}}