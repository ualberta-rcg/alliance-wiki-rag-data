[
  {
    "question": "What is the recommended alternative for remotely starting graphical user interfaces for complex software when SSH and X11 forwarding is too slow?",
    "answer": "The recommended alternative is to use Virtual Network Computing (VNC) to connect to a remote desktop."
  },
  {
    "question": "What is the first step required to use VNC to connect to a remote desktop?",
    "answer": "First, you need to install a VNC client on your local machine to connect to the VNC server."
  },
  {
    "question": "Which VNC client is recommended?",
    "answer": "TigerVNC is the recommended VNC client."
  },
  {
    "question": "On which operating systems is a TigerVNC package available?",
    "answer": "A TigerVNC package is available for Windows, MacOS, and most Linux distributions."
  },
  {
    "question": "When are certificate configuration steps required for TigerVNC?",
    "answer": "The certificate configuration steps are only required for connecting to VDI nodes so the signing authority of the certificate presented by the vncserver is known."
  },
  {
    "question": "What should you do if a popup about a certificate issue occurs while using TigerVNC?",
    "answer": "If a popup about a certificate issue occurs, it means you have not configured it properly or you are not connected to the server, and you should not enter your password."
  },
  {
    "question": "How do you install TigerVNC Viewer on Windows?",
    "answer": "On Windows, you should download and run the latest stable `vncviewer64-x.y.z.exe` version package installer from the official download page (e.g., `vncviewer64-1.15.0.exe`). Make sure to download the viewer and not the server."
  },
  {
    "question": "What is needed on Windows to create secure SSH tunnels for VNC?",
    "answer": "To create secure tunnels from your desktop to the vncserver on Windows, you will need to open a terminal window (such as PowerShell on Windows 10 since the 1809 update) and run the SSH command."
  },
  {
    "question": "How do you install TigerVNC Viewer on MacOS?",
    "answer": "On MacOS, install the latest stable DMG package from the official download page (e.g., `TigerVNC-1.15.0.dmg`). Double click the DMG, then drag the TigerVNC Viewer icon into the Applications folder and/or the lower app dock. To unmount the DMG, open a New Finder Window, select `View->ShowSidebar`, click the small up arrow beside the DMG name in the left sidebar, and close the Finder window."
  },
  {
    "question": "What should be done if TigerVNC crashes on macOS Monterey 12.2?",
    "answer": "If TigerVNC crashes on macOS Monterey 12.2, you must upgrade to the latest version."
  },
  {
    "question": "What is the installation command for TigerVNC viewer on Debian or Ubuntu?",
    "answer": "For Debian or Ubuntu, the installation command is `sudo apt-get install tigervnc-viewer`."
  },
  {
    "question": "What is the installation command for TigerVNC viewer on Fedora, CentOS, or RHEL?",
    "answer": "For Fedora, CentOS, or RHEL, the installation command is `sudo yum install tigervnc`."
  },
  {
    "question": "What is the installation command for TigerVNC viewer on Gentoo?",
    "answer": "For Gentoo, the installation command is `emerge -av net-misc/tigervnc`."
  },
  {
    "question": "How do you configure TigerVNC Viewer for security on Linux after installation?",
    "answer": "After installation, start TigerVNC, then in the 'VNC Viewer: Connection Details' window, click 'Options -> Security', tick all boxes except 'Encryption None', and enter the appropriate 'Path to X509 CA Certificate' for your Linux version. Click OK, then Connect to save settings."
  },
  {
    "question": "What is the 'Path to X509 CA Certificate' for TigerVNC on Debian or Ubuntu?",
    "answer": "The 'Path to X509 CA Certificate' for Debian or Ubuntu is `/etc/ssl/certs/ca-certificates.crt`."
  },
  {
    "question": "What is the 'Path to X509 CA Certificate' for TigerVNC on Fedora, CentOS, or RHEL?",
    "answer": "The 'Path to X509 CA Certificate' for Fedora, CentOS, or RHEL is `/etc/pki/tls/certs/ca-bundle.crt`."
  },
  {
    "question": "What is the 'Path to X509 CA Certificate' for TigerVNC on Gentoo?",
    "answer": "The 'Path to X509 CA Certificate' for Gentoo is `/etc/ssl/certs/ca-certificates.crt`."
  },
  {
    "question": "What types of applications can be run within a remote VNC desktop on a cluster login node?",
    "answer": "You may run lightweight applications that do not require a GPU within a remote VNC desktop on a cluster login node."
  },
  {
    "question": "What limitations apply when running a VNC server on a cluster login node?",
    "answer": "When running a VNC server on a cluster login node, memory and cputime limits apply."
  },
  {
    "question": "How can you check for old VNC servers running on a cluster login node?",
    "answer": "You can check for old unused VNC servers by running `vncserver -list` on the login node."
  },
  {
    "question": "How can you terminate all old VNC servers for your user on a login node?",
    "answer": "You can terminate all old VNC servers for your user on a login node by running `pkill Xvnc -u $USER`."
  },
  {
    "question": "How do you start a VNC server on a login node with an idle timeout?",
    "answer": "You can start a VNC server on a login node with an idle timeout by running `vncserver -idletimeout 86400` (where 86400 is the timeout in seconds)."
  },
  {
    "question": "What is the purpose of the `-idletimeout` option when starting a VNC server?",
    "answer": "The `-idletimeout` option ensures your vncserver eventually terminates (once the specified seconds have elapsed with no VNC viewer connections) should you forget to terminate your vncviewer session."
  },
  {
    "question": "What happens the first time you start a vncserver?",
    "answer": "The first time you start a vncserver, you will be required to set a password."
  },
  {
    "question": "What is the purpose of the VNC server password?",
    "answer": "The VNC server password is required to remotely connect to your desktop with a vncclient (such as vncviewer)."
  },
  {
    "question": "How can you enable multiple connections to a VNC server?",
    "answer": "Multiple connections can be made to a VNC server if it was started by appending the additional `-alwaysshared` option."
  },
  {
    "question": "How do you determine the TCP port your VNC server is listening on after it's started?",
    "answer": "You can determine the TCP port your VNC server is listening on by running `grep -iE \"\\sport|kill\" /home/yourusername/.vnc/l4.nibi.sharcnet:1.log` on the login node, where `l4.nibi.sharcnet:1.log` is the specific log file for your session."
  },
  {
    "question": "What command is used on the desktop to establish an SSH tunnel for VNC connections to a login node, for non-nibi clusters?",
    "answer": "On your desktop, to establish an SSH tunnel to a login node for non-nibi clusters, the command is `ssh nibi.computecanada.ca -L 5905:l4:5901` (replacing `nibi.computecanada.ca` with the cluster, `l4` with the login node, `5905` with the local forwarded port, and `5901` with the remote listening port)."
  },
  {
    "question": "How do you connect to a VNC server via a forwarded port using `vncviewer` on a Linux desktop?",
    "answer": "On a Linux desktop command line, you connect with `vncviewer localhost:5905` (replacing `5905` with your local forwarded port)."
  },
  {
    "question": "How do Mac or Windows users connect to a VNC server via a forwarded port using the TigerVNC Viewer application?",
    "answer": "Mac or Windows users can click the *TigerVNC Viewer* application icon on their desktop and enter `localhost:5905` (replacing `5905` with your local forwarded port) in the 'Connection Details' dialogue box."
  },
  {
    "question": "When might you need to start a VNC server on a compute node instead of a login node?",
    "answer": "You might need to start a VNC server on a compute node if you require more resources than the strict memory and cputime limits on cluster login nodes, or where VDI login nodes are unavailable."
  },
  {
    "question": "What are the limitations of running a VNC server on a compute node?",
    "answer": "Running a VNC server on a compute node does not provide a full graphical desktop or hardware-accelerated OpenGL."
  },
  {
    "question": "Before starting a VNC server on a compute node, what command should be used to allocate resources?",
    "answer": "Before starting a VNC server on a compute node, you should log into a cluster and create a compute node allocation using the `salloc` command, for example: `salloc --time=1:00:00 --cpus-per-task=4 --mem=16000 --account=def-piusername`."
  },
  {
    "question": "What environment variable should be set on a compute node to avoid repetitive desktop errors after an interactive job starts?",
    "answer": "You should set the environment variable `export XDG_RUNTIME_DIR=${SLURM_TMPDIR}`."
  },
  {
    "question": "What is important to remember when setting the VNC server password on a compute node?",
    "answer": "It is important to remember NOT to leave the VNC server password blank, otherwise anyone could connect and gain access to your account's files."
  },
  {
    "question": "How can you change the VNC server password later?",
    "answer": "You can change the VNC server password later using the `vncpasswd` command."
  },
  {
    "question": "What happens if you exit the node your SSH tunnel is connected to while using VNC?",
    "answer": "If you exit the node that your tunnel is connected to, you will no longer be able to connect to the VNC server with vncviewer, but your vncserver will continue running, allowing you to regain access by simply starting a new tunnel."
  },
  {
    "question": "What command is used for SSH tunneling to a compute node on nibi?",
    "answer": "For nibi, the SSH tunnel command is `ssh -J username@nibi.alliancecan.ca -L 5905:localhost:5901 c48` (replacing `username`, `5905`, `5901`, and `c48` with the actual values)."
  },
  {
    "question": "What is a prerequisite for using the new SSH tunnel command form for nibi?",
    "answer": "A prerequisite for using the new SSH tunnel command form for nibi is that an SSH key pair must be created on your laptop, and the contents of the public key must be entered into your `~/.ssh/authorized_keys` file on nibi."
  },
  {
    "question": "What kind of desktop environment is presented once `vncviewer` connects?",
    "answer": "Once `vncviewer` connects, you will be presented with a Linux MATE desktop."
  },
  {
    "question": "How do you launch a terminal from the MATE desktop?",
    "answer": "To launch a terminal from the MATE desktop, click on the top menu on 'Applications -> System Tools -> MATE Terminal'."
  },
  {
    "question": "If you experience graphics issues when using VNC, what alternatives are suggested?",
    "answer": "If you experience graphics issues, try using OpenOnDemand on nibi cluster or JupyterHub on rorqual cluster, as they offer automated VDI web interface GUI experiences with improved hardware performance and software support."
  },
  {
    "question": "How can you reset your VNC server password?",
    "answer": "You can reset your VNC server password using the `vncpasswd` command."
  },
  {
    "question": "How can you completely remove your VNC configuration, including your password?",
    "answer": "You can completely remove your VNC configuration by deleting your `~/.vnc` directory. The next time you run `vncserver`, you will be prompted to set a new password."
  },
  {
    "question": "How do you terminate a specific running VNC server session?",
    "answer": "You can terminate a specific running VNC server session with `vncserver -kill :DISPLAY#`, for example, `vncserver -kill :44`."
  },
  {
    "question": "How can you see all VNC servers running under your username?",
    "answer": "All vncserver(s) running under your username can be displayed with `vncserver -list`."
  },
  {
    "question": "What allows multiple users to connect to the same VNC server session?",
    "answer": "If a vncserver was started with the additional `-AlwaysShared` option, then multiple connections to it can be made by establishing new tunnels and vncviewers from any remote location."
  },
  {
    "question": "What is a common cause of repeated failures to establish a new VNC server/viewer connection?",
    "answer": "Repeated failing attempts to establish a new vncserver/vncviewer connection may be due to an old SSH tunnel still running on your desktop tying up ports."
  },
  {
    "question": "How can you identify and kill old SSH tunnels on your desktop?",
    "answer": "To identify and kill old SSH tunnels, open a terminal window on your desktop and run `ps ux | grep ssh` followed by `kill PID` (where PID is the process ID of the old tunnel)."
  },
  {
    "question": "Which password should be used to unlock the VNC screensaver if it times out?",
    "answer": "If your VNC screensaver times out and requests a password, you should enter your cluster account password to unlock it (not your vncserver password)."
  },
  {
    "question": "If the MATE desktop screensaver will not unlock, what command can be used?",
    "answer": "If you are running the MATE desktop and the screensaver will not unlock, you can try running `killall -9 .mate-screensaver`."
  },
  {
    "question": "What is the two-step process to log in to `gra-vdi.alliancecan.ca`?",
    "answer": "The two-step process to log in is: 1) Enter your username and CCDB password, then 2) Enter your username and Duo two-factor MFA passcode."
  },
  {
    "question": "What happens if you enter the wrong CCDB password during the first step of logging into `gra-vdi.alliancecan.ca`?",
    "answer": "If you enter the wrong username/password for the first step, you will still be prompted for the second step, but after sending your username/passcode, you will receive a message saying 'Success, Logging you in...' and be returned to the first login screen."
  },
  {
    "question": "How do you reset your Alliance CCDB password if you forget it?",
    "answer": "If you cannot recall your Alliance CCDB password, you can visit `https://ccdb.alliancecan.ca/security/forgot` to reset it, assuming your account is not pending renewal by your PI."
  },
  {
    "question": "Do VDI nodes load software modules by default?",
    "answer": "No, on VDI nodes, no modules are loaded by default, unlike regular login nodes where a standard software environment and some default modules are automatically loaded."
  },
  {
    "question": "What module do most users find sufficient to load on `gra-vdi`?",
    "answer": "Most users will find it sufficient to load the `StdEnv` module on `gra-vdi`."
  },
  {
    "question": "What software access does loading the `StdEnv` module on `gra-vdi` provide?",
    "answer": "Loading the `StdEnv` module on `gra-vdi` provides access to the same software modules that are loaded by default on the clusters."
  },
  {
    "question": "When might users need to load the `SnEnv` module on `gra-vdi`?",
    "answer": "In some rare cases, users will need to load a locally installed module(s) on `gra-vdi`, for which the `SnEnv` must first be loaded."
  },
  {
    "question": "Is the `nix` module currently available on `gra-vdi` or `graham`?",
    "answer": "No, the `nix` module is no longer available on `gra-vdi` (or graham), and there is no guarantee it will return."
  },
  {
    "question": "In the past, what was the `nix` module used for?",
    "answer": "In the past, the `nix` module provided open-source software that was optimized to use accelerated OpenGL whenever possible."
  },
  {
    "question": "How did users historically install software into their `nix` environment?",
    "answer": "Historically, users would first run `module load nix`, then use `nix search <regexp>` to find programs and `nix-env --install --attr <attribute>` to install them (e.g., `nix-env --install --attr nixpkgs.qgis` for QGIS)."
  },
  {
    "question": "Did the `nix` environment persist across logins?",
    "answer": "Yes, the `nix` environment persisted from one login to the next, meaning installed software would be available each time the `nix` module was loaded."
  },
  {
    "question": "What was necessary for accelerated OpenGL to work with compiled binaries when using `nix`?",
    "answer": "For accelerated OpenGL to work, it was necessary to adjust compiled binaries to pre-load 'vglfaker.so' from VirtualGL, which `nix` did automatically for software installed via its package manager."
  },
  {
    "question": "How could one manually adjust an OpenGL application for VirtualGL if it wasn't installed via `nix`?",
    "answer": "One could manually adjust an OpenGL application by using the `patchelf` utility to add the VirtualGL system library `/usr/lib64/VirtualGL/libvglfaker.so` to the binary, for example: `patchelf --add-needed /usr/lib64/VirtualGL/libvglfaker.so ~/.local/bin/myglapp`."
  },
  {
    "question": "Why is preloading `vglfaker.so` via `LD_PRELOAD` generally a bad idea?",
    "answer": "Preloading `vglfaker.so` via `LD_PRELOAD` is generally a bad idea because it applies indiscriminately to all binaries, and those that require a different `vglfaker.so` than what is set in `LD_PRELOAD` will then fail."
  }
]