[
  {
    "question": "What are the SBATCH directives for a single-node Ansys Workbench job using StdEnv/2020?",
    "answer": "For a single-node Ansys Workbench job with StdEnv/2020, use `#SBATCH --account=def-account`, `#SBATCH --time=00-03:00`, `#SBATCH --mem=16G`, `#SBATCH --ntasks=4`, and `#SBATCH --nodes=1`. Optional directives include `--exclusive` for scaling tests or `--constraint=broadwell` for graham or cedar."
  },
  {
    "question": "How is memory parallelism configured for Ansys Workbench jobs?",
    "answer": "For single-node Workbench jobs (`SLURM_NNODES == 1`), `MEMPAR` should be set to 0 for Shared Memory Parallel (SMP). Otherwise, `MEMPAR` should be set to 1 for Distributed Memory Parallel (DMP)."
  },
  {
    "question": "What environment variables are set for Ansys Workbench jobs?",
    "answer": "`KMP_AFFINITY` is set to `disabled` and `I_MPI_HYDRA_BOOTSTRAP` is set to `ssh` for Ansys Workbench jobs."
  },
  {
    "question": "What command is used to run Ansys Workbench in batch mode?",
    "answer": "The command `runwb2 -B -E \"Update()\" -F YOURPROJECT.wbpj` is used to run Ansys Workbench in batch mode."
  },
  {
    "question": "How can an APDL input file be generated from an Ansys Workbench Mechanical session?",
    "answer": "An APDL input file can be generated from an interactive Workbench Mechanical session by navigating to 'Solution -> Tools -> Write Input Files', specifying a `File name:` like YOURAPDLFILE.inp, and selecting `Save as type: APDL Input Files (*.inp)`."
  },
  {
    "question": "What do lines starting with `##SBATCH` indicate in Slurm scripts for Ansys Mechanical (APDL)?",
    "answer": "In Slurm scripts for Ansys Mechanical (APDL), lines beginning with `##SBATCH` are commented out and represent optional or conditional parameters."
  },
  {
    "question": "What Ansys module version is recommended for Mechanical (APDL) jobs using StdEnv/2023?",
    "answer": "For Mechanical (APDL) jobs using StdEnv/2023, `ansys/2024R1.03` is loaded, though `ansys/2023R2` is also mentioned as an option."
  },
  {
    "question": "How do you specify the number of cores for a Shared Memory Parallel (SMP) CPU job in Ansys Mechanical (APDL)?",
    "answer": "For an SMP CPU job in Ansys Mechanical (APDL), specify the number of cores using `#SBATCH --tasks=8` and ensure `#SBATCH --cpus-per-task=1`."
  },
  {
    "question": "What command is used to run a Shared Memory Parallel (SMP) CPU job in Ansys Mechanical (APDL)?",
    "answer": "The command `mapdl -smp -b nolist -np $SLURM_NTASKS -dir outdir-$SLURM_JOBID -i YOURAPDLFILE.inp` is used to run an SMP CPU job."
  },
  {
    "question": "How is the `LD_LIBRARY_PATH` set for Ansys Mechanical (APDL) CPU jobs on Cedar?",
    "answer": "On Cedar, for CPU jobs, `LD_LIBRARY_PATH` is exported to `$EBROOTGCC/../lib/gcc` for SMP, and a symlink to `libstdc++.so.6.0.29` is created in `outdir-$SLURM_JOBID` with `LD_LIBRARY_PATH` set to `$PWD/outdir-$SLURM_JOBID` for DMP."
  },
  {
    "question": "What specific settings are applied for Distributed Memory Parallel (DMP) CPU jobs on Beluga?",
    "answer": "For DMP CPU jobs on Beluga, `KMP_AFFINITY` is exported as `none`, and the job uses `mapdl -dis -mpi intelmpi`."
  },
  {
    "question": "What command is used to run a Distributed Memory Parallel (DMP) CPU job in Ansys Mechanical (APDL) on clusters other than Beluga?",
    "answer": "On clusters other than Beluga, a DMP CPU job uses the command `mapdl -dis -mpi openmpi -b nolist -np $SLURM_NTASKS -dir outdir-$SLURM_JOBID -i YOURAPDLFILE.inp`."
  },
  {
    "question": "How do you request GPUs for a Shared Memory Parallel (SMP) GPU job in Ansys Mechanical (APDL)?",
    "answer": "Request GPUs for an SMP GPU job using `#SBATCH --gpus-per-node=1` (or specific types like `#SBATCH --gpus-per-node=h100:1` for mini-graham)."
  },
  {
    "question": "What environment variable is used to print GPU device information for Ansys Mechanical (APDL) jobs?",
    "answer": "The environment variable `ANSGPU_PRINTDEVICES` set to `1` is used to print GPU device information for Ansys Mechanical (APDL) jobs."
  },
  {
    "question": "What is the `mapdl` command for a Shared Memory Parallel (SMP) GPU job?",
    "answer": "The `mapdl` command for an SMP GPU job is `mapdl -smp -acc nvidia -na $SLURM_GPUS_ON_NODE -b nolist -np $SLURM_NTASKS -dir outdir-$SLURM_JOBID -i YOURAPDLFILE.inp`."
  },
  {
    "question": "How does the `mapdl` command differ for a Distributed Memory Parallel (DMP) GPU job on Beluga compared to other clusters?",
    "answer": "On Beluga, the DMP GPU job uses `mapdl -dis -acc nvidia -na $SLURM_GPUS_ON_NODE -mpi intelmpi` with `export KMP_AFFINITY=none`, while other clusters use `mapdl -dis -acc nvidia -na $SLURM_GPUS_ON_NODE -mpi openmpi`."
  },
  {
    "question": "What is the default memory allocation for APDL jobs in Ansys?",
    "answer": "Ansys allocates 1024 MB total memory and 1024 MB database memory by default for APDL jobs."
  },
  {
    "question": "How can you manually change the total and database memory for APDL jobs?",
    "answer": "You can manually change the total and database memory by adding `-m <total_memory_MB>` and/or `-db <database_memory_MB>` arguments to the `mapdl` command line in your scripts, for example `-m 1024 -db 1024`."
  },
  {
    "question": "What additional arguments might be needed for `mapdl` when using a remote institutional license server with multiple Ansys licenses?",
    "answer": "When using a remote institutional license server with multiple Ansys licenses, it may be necessary to add `-p aa_r` or `-ppf anshpc` to the `mapdl` command, depending on the Ansys module in use."
  },
  {
    "question": "What is the recommended practice before running production jobs in Ansys Mechanical (APDL)?",
    "answer": "It is always recommended to perform detailed scaling tests before running production jobs to ensure that the optimal number of cores and minimum amount of memory are specified in your scripts."
  },
  {
    "question": "Which type of Mechanical (APDL) script is generally preferred for performance?",
    "answer": "The single-node (SMP Shared Memory Parallel) scripts will typically perform better than the multinode (DIS Distributed Memory Parallel) scripts and should be used whenever possible."
  },
  {
    "question": "How can you check the Ansys version used to generate an APDL input file?",
    "answer": "You can check the Ansys version by using `cat YOURAPDLFILE.inp | grep version`, which will show a line like `! ANSYS input file written by Workbench version 2019 R3`."
  }
]