[
  {
    "question": "How do you start a VNC server on a compute node?",
    "answer": "After logging into a compute node, run the `vncserver` command. It will display information like 'Desktop 'TurboVNC: c48.nibi.sharcnet:1 (yourusername)' started on display c48.nibi.sharcnet:1' and the path to the log file."
  },
  {
    "question": "Where is the log file for the VNC server located on a compute node?",
    "answer": "The log file is typically located at `/home/yourusername/.vnc/c48.nibi.sharcnet:1.log`, where `c48.nibi.sharcnet:1` will reflect your specific compute node and display number."
  },
  {
    "question": "How can you determine which TCP port your VNC server is listening on?",
    "answer": "Run `grep -iE \"\\sport|kill\" /home/yourusername/.vnc/c48.nibi.sharcnet:1.log` on the compute node. The output will show the listening port, for example, 'Listening for VNC connections on TCP port 5901'."
  },
  {
    "question": "What is the general SSH tunnel command format for connecting to a VNC server on most clusters (excluding nibi)?",
    "answer": "The command format is `ssh username@clustername -L localforwardedport:computenode:remotelisteningport`."
  },
  {
    "question": "Provide an example of setting up an SSH tunnel to a VNC server on a 'rorqual' cluster compute node 'rc12509', using local port 5905 and remote port 5901.",
    "answer": "The command would be `ssh username@rorqual.alliancecan.ca -L 5905:rc12509:5901`."
  },
  {
    "question": "What is the specific SSH tunnel command format required for the 'nibi' cluster?",
    "answer": "For 'nibi', the command format is `ssh -J username@clustername -L localforwardedport:localhost:remotelisteningport computenode`. An SSH key pair must also be created on your laptop, with the public key in your `~/.ssh/authorized_keys` file on `nibi`."
  },
  {
    "question": "Give an example of setting up an SSH tunnel to a VNC server on a 'nibi' compute node 'c48', using local port 5905 and remote port 5901.",
    "answer": "The command would be `ssh -J username@nibi.alliancecan.ca -L 5905:localhost:5901 c48`."
  },
  {
    "question": "What happens to the VNC server if you exit the compute node your SSH tunnel is connected to?",
    "answer": "If you exit the node, the SSH tunnel will break, and you will no longer be able to connect with vncviewer. However, the vncserver will continue running, and you can regain access by starting a new tunnel."
  },
  {
    "question": "How do you connect to a VNC server from a Linux desktop after setting up an SSH tunnel?",
    "answer": "Open a new local terminal window and run the `vncviewer` command, specifying `localhost:port`. For example, `vncviewer localhost:5905`."
  },
  {
    "question": "How do Mac or Windows users connect to a VNC server using TigerVNC Viewer?",
    "answer": "Mac or Windows users can click the TigerVNC Viewer application icon and enter `localhost:port` in the \"Connection Details\" dialogue box."
  },
  {
    "question": "What is the default VNC port assumed by TigerVNC Viewer?",
    "answer": "The default VNC port assumed by TigerVNC Viewer is 5900. If your local forwarded port is 5900, you can simply specify `localhost` in the connection details."
  },
  {
    "question": "What kind of desktop environment is presented once `vncviewer` connects?",
    "answer": "`vncviewer` connects you to a Linux MATE desktop."
  },
  {
    "question": "How can you launch a terminal in the Linux MATE desktop through VNC?",
    "answer": "To launch a terminal, click on the top menu on \"Applications -> System Tools -> MATE Terminal\"."
  },
  {
    "question": "How do you reset your VNC server password?",
    "answer": "Use the `vncpasswd` command from the terminal on the cluster node. You will be prompted to enter and verify a new password, and optionally a view-only password."
  },
  {
    "question": "How can you completely remove your VNC configuration, including the password?",
    "answer": "Delete your `~/.vnc` directory. The next time you run `vncserver`, you will be prompted to set a new password."
  },
  {
    "question": "How do you terminate a specific running vncserver?",
    "answer": "First, list your VNC sessions using `vncserver -list` to find the display number (e.g., `:44`). Then, terminate it with `vncserver -kill :DISPLAY#`, for example, `vncserver -kill :44`."
  },
  {
    "question": "How can you instantly kill all vncservers running under your username on a node?",
    "answer": "Run the command `pkill Xvnc -u $USER`."
  },
  {
    "question": "What option is required to allow multiple connections to a VNC server?",
    "answer": "The `vncserver` must be started with the additional `-AlwaysShared` option, for example, `vncserver -idletimeout 86400 -alwaysshared`."
  },
  {
    "question": "What is a common reason for repeated failures to establish a VNC server/viewer connection?",
    "answer": "Repeated failures may be due to an old SSH tunnel still running on your desktop and tying up ports."
  },
  {
    "question": "How do you identify and kill old SSH tunnels on your desktop that might be causing connection failures?",
    "answer": "Open a terminal window on your desktop, run `ps ux | grep ssh` to identify the process ID (PID) of any lingering SSH tunnels, and then use `kill PID` to terminate them."
  }
]